<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#231c52">
    <meta
        name="description"
        content="Heavy Study Ensemble ‚Äî –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –∞–Ω—Å–∞–º–±–ª–µ–º Flash, Qwen, DeepSeek –∏ Grok –ø–ª—é—Å –∞—Ä–±–∏—Ç—Ä –¥–ª—è –≤—ã–±–æ—Ä–∞ –ª—É—á—à–µ–≥–æ –æ—Ç–≤–µ—Ç–∞"
    >

    <title>Heavy Study Ensemble</title>

    <link rel="manifest" href="manifest.json">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
</head>
<body>
    <div class="app-shell">
        <header class="app-header">
            <div class="header-inner">
                <div class="brand">
                    <div class="brand-mark">üß†</div>
                    <div class="brand-text">
                        <h1>Heavy Study Ensemble</h1>
                        <p>Flash + Qwen + DeepSeek + Grok —Å Thinking –∏ –∞—Ä–±–∏—Ç—Ä–æ–º</p>
                    </div>
                </div>
                <div class="header-actions">
                    <button id="api-key-btn" class="pill-btn pill-btn-outline" aria-haspopup="dialog">
                        –ù–∞—Å—Ç—Ä–æ–∏—Ç—å OpenRouter
                    </button>
                    <button id="theme-toggle" class="icon-btn" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
                        <svg class="theme-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                    </button>
                    <button id="history-btn" class="icon-btn" aria-label="–ò—Å—Ç–æ—Ä–∏—è">
                        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </header>

        <main class="main-layout">
            <section class="hero" id="hero">
                <div class="hero-copy">
                    <h2>–ê–Ω—Å–∞–º–±–ª—å —Å–∏–ª—å–Ω–µ–π—à–∏—Ö open-–º–æ–¥–µ–ª–µ–π –ø–æ–¥ –∑–∞–¥–∞—á–∫–∏</h2>
                    <p>
                        –ó–∞–≥—Ä—É–∑–∏ —Ñ–æ—Ç–æ –∏–ª–∏ –≤–ø–∏—à–∏ —É—Å–ª–æ–≤–∏–µ ‚Äî Flash 2.5, Qwen 3 Max, DeepSeek R1 –∏ Grok —Ä–µ—à–∞—Ç –∑–∞–¥–∞—á—É –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ,
                        –∞ –∞—Ä–±–∏—Ç—Ä Gemini –≤—ã–±–µ—Ä–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ —Ç–æ—á–Ω—ã–π –æ—Ç–≤–µ—Ç.
                    </p>
                    <div class="hero-actions">
                        <button class="pill-btn pill-btn-primary" id="hero-start-btn">–ù–∞—á–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ</button>
                        <button class="pill-btn pill-btn-ghost" id="hero-api-btn">–î–æ–±–∞–≤–∏—Ç—å OpenRouter –∫–ª—é—á</button>
                    </div>
                    <ul class="hero-features">
                        <li>üß© Flash 2.5 —Ç—Ä–∏–∂–¥—ã –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –≤–∞—Ä–∏–∞–Ω—Ç—ã —Å Thinking</li>
                        <li>ü§ù Qwen 3 Max + DeepSeek R1 + Grok –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫–∞–∫ –¥—É—ç—Ç —ç–∫—Å–ø–µ—Ä—Ç–æ–≤</li>
                        <li>‚úÖ –ê—Ä–±–∏—Ç—Ä –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤—Å–µ –æ—Ç–≤–µ—Ç—ã –∏ –æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ 100/100</li>
                    </ul>
                </div>
                <div class="hero-visual">
                    <div class="mockup-card">
                        <h3>–ü–∞–π–ø–ª–∞–π–Ω Heavy Grok</h3>
                        <ol>
                            <li>–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞: OCR, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—Å—Ç–∞ –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–¥–∞—á–∏.</li>
                            <li>–ê–Ω—Å–∞–º–±–ª—å: 3√ó Flash + Qwen + DeepSeek + Grok —Å Thinking.</li>
                            <li>–ê—Ä–±–∏—Ç—Ä–∞–∂: Gemini —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç reasoning –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç.</li>
                        </ol>
                        <div class="mockup-highlight">–ù–∏–∫–∞–∫–æ–π —Ä—É—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Äî –ø—Ä–æ—Å—Ç–æ –≤—Å—Ç–∞–≤—å –∑–∞–¥–∞—á—É.</div>
                    </div>
                </div>
            </section>

            <div id="status-bar" class="status-bar hidden">
                <div class="status-icon">‚ÑπÔ∏è</div>
                <div class="status-text"></div>
            </div>

            <section class="workspace" id="workspace">
                <div id="input-section" class="panel">
                    <div class="panel-header">
                        <h2>–†–µ—à–∏—Ç—å –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É</h2>
                        <p>–ó–∞–≥—Ä—É–∑–∏ —Ñ–æ—Ç–æ, —Ñ–∞–π–ª –∏–ª–∏ –≤–≤–µ–¥–∏ —É—Å–ª–æ–≤–∏–µ –≤—Ä—É—á–Ω—É—é ‚Äî –∞–Ω—Å–∞–º–±–ª—å —Å–¥–µ–ª–∞–µ—Ç –æ—Å—Ç–∞–ª—å–Ω–æ–µ.</p>
                    </div>

                    <div class="input-grid">
                        <button id="camera-btn" class="action-tile">
                            <div class="tile-icon">üì∏</div>
                            <div class="tile-title">–°—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—Ä–æ–≤–∞—Ç—å</div>
                            <div class="tile-desc">–û—Ç–∫—Ä–æ–µ—Ç—Å—è –∫–∞–º–µ—Ä–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</div>
                        </button>
                        <button id="upload-btn" class="action-tile">
                            <div class="tile-icon">üñºÔ∏è</div>
                            <div class="tile-title">–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ –≥–∞–ª–µ—Ä–µ–∏</div>
                            <div class="tile-desc">–ü–æ–¥–¥–µ—Ä–∂–∫–∞ PNG, JPG, HEIC</div>
                        </button>
                        <button id="paste-btn" class="action-tile">
                            <div class="tile-icon">üìã</div>
                            <div class="tile-title">–í—Å—Ç–∞–≤–∏—Ç—å –∏–∑ –±—É—Ñ–µ—Ä–∞</div>
                            <div class="tile-desc">–†–∞–±–æ—Ç–∞–µ—Ç –∏ –¥–ª—è —Ç–µ–∫—Å—Ç–∞, –∏ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</div>
                        </button>
                    </div>

                    <input type="file" id="file-input" accept="image/*" capture="environment" hidden>
                    <input type="file" id="upload-input" accept="image/*" hidden>

                    <div id="preview-container" class="preview-container hidden">
                        <img id="preview-image" class="preview-image" alt="–ó–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">
                        <button id="remove-image" class="pill-btn pill-btn-outline">–£–¥–∞–ª–∏—Ç—å —Ñ–æ—Ç–æ</button>
                    </div>

                    <label for="text-input" class="field-label">–ò–ª–∏ –≤–≤–µ–¥–∏—Ç–µ –∑–∞–¥–∞—á—É –≤—Ä—É—á–Ω—É—é</label>
                    <textarea id="text-input" class="text-input" rows="5" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –†–µ—à–∏—Ç–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ 2x + 5 = 15"></textarea>

                    <button id="solve-btn" class="cta-btn" disabled>
                        <span class="cta-label">–ó–∞–ø—É—Å—Ç–∏—Ç—å Heavy –∞–Ω—Å–∞–º–±–ª—å</span>
                        <span class="cta-sub">Flash √ó3 + Qwen + DeepSeek + Grok + –∞—Ä–±–∏—Ç—Ä</span>
                    </button>
                </div>

                <section id="processing-section" class="panel hidden">
                    <div class="processing-card">
                        <div class="spinner"></div>
                        <div class="processing-copy">
                            <h3 id="processing-title">–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è...</h3>
                            <p id="processing-text">–†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —Å —Ñ–æ—Ç–æ</p>
                        </div>
                    </div>
                </section>

                <section id="solution-section" class="panel hidden">
                    <div class="panel-header with-action">
                        <div>
                            <h2>–§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –∞—Ä–±–∏—Ç—Ä–∞</h2>
                            <p>–ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ—à—ë–ª Thinking –∏ –∞—Ä–±–∏—Ç—Ä–∞–∂</p>
                        </div>
                        <button id="new-task-btn" class="pill-btn pill-btn-outline">–ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞</button>
                    </div>

                    <div id="recognized-text" class="recognized-block hidden">
                        <h3>–†–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞</h3>
                        <div id="recognized-content" class="recognized-content"></div>
                    </div>

                    <div class="solution-summary">
                        <article id="solution-content" class="solution-content"></article>
                        <div class="solution-meta">
                            <div class="meta-item">
                                <span>–í—ã–±—Ä–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å</span>
                                <strong id="arbiter-chosen">‚Äî</strong>
                            </div>
                            <div class="meta-item">
                                <span>–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å</span>
                                <strong id="arbiter-confidence">‚Äî</strong>
                            </div>
                        </div>
                    </div>

                    <section id="arbiter-report" class="arbiter-card hidden">
                        <header>
                            <h3>–ê—Ä–±–∏—Ç—Ä ‚Äî –≥–æ–ª–æ—Å –∑–∞ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç</h3>
                            <span id="arbiter-model-badge" class="model-badge"></span>
                        </header>
                        <p id="arbiter-reason" class="arbiter-reason"></p>
                        <details class="thinking-block hidden" id="arbiter-thinking-block">
                            <summary>–ü–æ–∫–∞–∑–∞—Ç—å Thinking –∞—Ä–±–∏—Ç—Ä–∞</summary>
                            <pre id="arbiter-thinking"></pre>
                        </details>
                    </section>

                    <section id="ensemble-results" class="ensemble-results"></section>

                    <div class="panel-footer">
                        <button id="save-solution-btn" class="pill-btn pill-btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –∏—Å—Ç–æ—Ä–∏—é</button>
                    </div>
                </section>

                <section id="history-section" class="panel hidden">
                    <div class="panel-header with-action">
                        <div>
                            <h2>–ò—Å—Ç–æ—Ä–∏—è —Ä–µ—à–µ–Ω–∏–π</h2>
                            <p>–í—Å–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –∫–µ–π—Å—ã –Ω–∞ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ</p>
                        </div>
                        <button id="close-history-btn" class="pill-btn pill-btn-outline">–ó–∞–∫—Ä—ã—Ç—å</button>
                    </div>

                    <div id="history-list" class="history-list">
                        <p class="empty-history">–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞</p>
                    </div>

                    <div class="panel-footer">
                        <button id="clear-history-btn" class="pill-btn pill-btn-danger">–û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é</button>
                    </div>
                </section>
            </section>
        </main>

        <footer class="app-footer">
            <div>
                <strong>–†–µ–∂–∏–º —Å–µ—Ç–∏:</strong>
                <span id="offline-status">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span>
            </div>
            <p>–†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –æ—Ç–∫—Ä—ã—Ç–æ–º API OpenRouter. Flash, Qwen, DeepSeek –∏ Grok –¥–µ–ª–∞—é—Ç Thinking, –∞—Ä–±–∏—Ç—Ä Gemini –≤—ã–±–∏—Ä–∞–µ—Ç —Ñ–∏–Ω–∞–ª.</p>
        </footer>
    </div>

    <div id="api-key-backdrop" class="modal-backdrop hidden"></div>
    <div id="api-key-dialog" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="api-key-title">
        <div class="modal-card">
            <header class="modal-header">
                <h2 id="api-key-title">OpenRouter API –∫–ª—é—á</h2>
                <button id="api-key-close" class="icon-btn" aria-label="–ó–∞–∫—Ä—ã—Ç—å">
                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </header>
            <div class="modal-body">
                <p>
                    –ö–ª—é—á —Ö—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –º–æ–¥–µ–ª–∏ OpenRouter: Gemini Flash, Qwen 3 Max,
                    DeepSeek R1, Grok Beta –∏ –¥—Ä—É–≥–∏–µ.
                </p>
                <label for="api-key-input" class="field-label">API –∫–ª—é—á</label>
                <input id="api-key-input" type="password" class="text-input" placeholder="sk-or-v1-...">
            </div>
            <footer class="modal-footer">
                <button id="api-key-clear" class="pill-btn pill-btn-outline">–£–¥–∞–ª–∏—Ç—å –∫–ª—é—á</button>
                <button id="api-key-save" class="pill-btn pill-btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </footer>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
    <script type="module" src="app.js"></script>
</body>
</html>
